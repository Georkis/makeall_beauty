/*!
 * Cropper v3.1.3
 * https://github.com/fengyuanchen/cropper
 *
 * Copyright (c) 2014-2017 Chen Fengyuan
 * Released under the MIT license
 *
 * Date: 2017-10-21T10:04:29.734Z
 */
;"use strict";function _interopDefault(a){return(a&&(typeof a==="object")&&"default" in a)?a["default"]:a}var $=_interopDefault(require("jquery"));var WINDOW=typeof window!=="undefined"?window:{};var NAMESPACE="cropper";var ACTION_ALL="all";var ACTION_CROP="crop";var ACTION_MOVE="move";var ACTION_ZOOM="zoom";var ACTION_EAST="e";var ACTION_WEST="w";var ACTION_SOUTH="s";var ACTION_NORTH="n";var ACTION_NORTH_EAST="ne";var ACTION_NORTH_WEST="nw";var ACTION_SOUTH_EAST="se";var ACTION_SOUTH_WEST="sw";var CLASS_CROP=NAMESPACE+"-crop";var CLASS_DISABLED=NAMESPACE+"-disabled";var CLASS_HIDDEN=NAMESPACE+"-hidden";var CLASS_HIDE=NAMESPACE+"-hide";var CLASS_INVISIBLE=NAMESPACE+"-invisible";var CLASS_MODAL=NAMESPACE+"-modal";var CLASS_MOVE=NAMESPACE+"-move";var DATA_ACTION="action";var DATA_PREVIEW="preview";var DRAG_MODE_CROP="crop";var DRAG_MODE_MOVE="move";var DRAG_MODE_NONE="none";var EVENT_CROP="crop";var EVENT_CROP_END="cropend";var EVENT_CROP_MOVE="cropmove";var EVENT_CROP_START="cropstart";var EVENT_DBLCLICK="dblclick";var EVENT_ERROR="error";var EVENT_LOAD="load";var EVENT_POINTER_DOWN=WINDOW.PointerEvent?"pointerdown":"touchstart mousedown";var EVENT_POINTER_MOVE=WINDOW.PointerEvent?"pointermove":"touchmove mousemove";var EVENT_POINTER_UP=WINDOW.PointerEvent?" pointerup pointercancel":"touchend touchcancel mouseup";var EVENT_READY="ready";var EVENT_RESIZE="resize";var EVENT_WHEEL="wheel mousewheel DOMMouseScroll";var EVENT_ZOOM="zoom";var REGEXP_ACTIONS=/^(e|w|s|n|se|sw|ne|nw|all|crop|move|zoom)$/;var REGEXP_DATA_URL=/^data:/;var REGEXP_DATA_URL_JPEG=/^data:image\/jpeg;base64,/;var REGEXP_TAG_NAME=/^(img|canvas)$/i;var DEFAULTS={viewMode:0,dragMode:DRAG_MODE_CROP,aspectRatio:NaN,data:null,preview:"",responsive:true,restore:true,checkCrossOrigin:true,checkOrientation:true,modal:true,guides:true,center:true,highlight:true,background:true,autoCrop:true,autoCropArea:0.8,movable:true,rotatable:true,scalable:true,zoomable:true,zoomOnTouch:true,zoomOnWheel:true,wheelZoomRatio:0.1,cropBoxMovable:true,cropBoxResizable:true,toggleDragModeOnDblclick:true,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:200,minContainerHeight:100,ready:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null};var TEMPLATE='<div class="cropper-container"><div class="cropper-wrap-box"><div class="cropper-canvas"></div></div><div class="cropper-drag-box"></div><div class="cropper-crop-box"><span class="cropper-view-box"></span><span class="cropper-dashed dashed-h"></span><span class="cropper-dashed dashed-v"></span><span class="cropper-center"></span><span class="cropper-face"></span><span class="cropper-line line-e" data-action="e"></span><span class="cropper-line line-n" data-action="n"></span><span class="cropper-line line-w" data-action="w"></span><span class="cropper-line line-s" data-action="s"></span><span class="cropper-point point-e" data-action="e"></span><span class="cropper-point point-n" data-action="n"></span><span class="cropper-point point-w" data-action="w"></span><span class="cropper-point point-s" data-action="s"></span><span class="cropper-point point-ne" data-action="ne"></span><span class="cropper-point point-nw" data-action="nw"></span><span class="cropper-point point-sw" data-action="sw"></span><span class="cropper-point point-se" data-action="se"></span></div></div>';function _toConsumableArray(a){if(Array.isArray(a)){for(var c=0,b=Array(a.length);c<a.length;c++){b[c]=a[c]}return b}else{return Array.from(a)}}function isString(a){return typeof a==="string"}var isNaN=Number.isNaN||WINDOW.isNaN;function isNumber(a){return typeof a==="number"&&!isNaN(a)}function isUndefined(a){return typeof a==="undefined"}function proxy(e,c){for(var a=arguments.length,b=Array(a>2?a-2:0),d=2;d<a;d++){b[d-2]=arguments[d]}return function(){for(var f=arguments.length,h=Array(f),g=0;g<f;g++){h[g]=arguments[g]}return e.apply(c,b.concat(h))}}var objectKeys=Object.keys||function objectKeys(b){var a=[];$.each(b,function(c){a.push(c)});return a};var REGEXP_DECIMALS=/\.\d*(?:0|9){12}\d*$/i;function normalizeDecimalNumber(a){var b=arguments.length>1&&arguments[1]!==undefined?arguments[1]:100000000000;return REGEXP_DECIMALS.test(a)?Math.round(a*b)/b:a}var location=WINDOW.location;var REGEXP_ORIGINS=/^(https?:)\/\/([^:/?#]+):?(\d*)/i;function isCrossOriginURL(a){var b=a.match(REGEXP_ORIGINS);return b&&(b[1]!==location.protocol||b[2]!==location.hostname||b[3]!==location.port)}function addTimestamp(a){var b="timestamp="+new Date().getTime();return a+(a.indexOf("?")===-1?"?":"&")+b}function getTransformValues(e){var d=e.rotate,c=e.scaleX,b=e.scaleY,g=e.translateX,f=e.translateY;var a=[];if(isNumber(g)&&g!==0){a.push("translateX("+g+"px)")}if(isNumber(f)&&f!==0){a.push("translateY("+f+"px)")}if(isNumber(d)&&d!==0){a.push("rotate("+d+"deg)")}if(isNumber(c)&&c!==1){a.push("scaleX("+c+")")}if(isNumber(b)&&b!==1){a.push("scaleY("+b+")")}return a.length?a.join(" "):"none"}var navigator=WINDOW.navigator;var IS_SAFARI_OR_UIWEBVIEW=navigator&&/(Macintosh|iPhone|iPod|iPad).*AppleWebKit/i.test(navigator.userAgent);function getImageNaturalSizes(a,c){if(a.naturalWidth&&!IS_SAFARI_OR_UIWEBVIEW){c(a.naturalWidth,a.naturalHeight);return}var b=document.createElement("img");b.onload=function(){c(b.width,b.height)};b.src=a.src}function getMaxZoomRatio(a){var c=$.extend({},a);var b=[];$.each(a,function(d,e){delete c[d];$.each(c,function(n,k){var g=Math.abs(e.startX-k.startX);var m=Math.abs(e.startY-k.startY);var f=Math.abs(e.endX-k.endX);var l=Math.abs(e.endY-k.endY);var i=Math.sqrt(g*g+m*m);var h=Math.sqrt(f*f+l*l);var j=(h-i)/i;b.push(j)})});b.sort(function(e,d){return Math.abs(e)<Math.abs(d)});return b[0]}function getPointer(e,d){var c=e.pageX,b=e.pageY;var a={endX:c,endY:b};if(d){return a}return $.extend({startX:c,startY:b},a)}function getPointersCenter(a){var c=0;var b=0;var d=0;$.each(a,function(g,h){var f=h.startX,e=h.startY;c+=f;b+=e;d+=1});c/=d;b/=d;return{pageX:c,pageY:b}}var isFinite=Number.isFinite||WINDOW.isFinite;function getContainSizes(e){var d=e.aspectRatio,a=e.height,c=e.width;var b=function b(f){return isFinite(f)&&f>0};if(b(c)&&b(a)){if(a*d>c){a=c/d}else{c=a*d}}else{if(b(c)){a=c/d}else{if(b(a)){c=a*d}}}return{width:c,height:a}}function getRotatedSizes(f){var e=f.width,b=f.height,g=f.degree;g=Math.abs(g);if(g%180===90){return{width:b,height:e}}var d=g%90*Math.PI/180;var a=Math.sin(d);var c=Math.cos(d);return{width:e*c+b*a,height:e*a+b*c}}function getSourceCanvas(d,i,h,f){var C=i.naturalWidth,x=i.naturalHeight,w=i.rotate,G=w===undefined?0:w,p=i.scaleX,A=p===undefined?1:p,n=i.scaleY,z=n===undefined?1:n;var t=h.aspectRatio,g=h.naturalWidth,j=h.naturalHeight;var H=f.fillColor,J=H===undefined?"transparent":H,B=f.imageSmoothingEnabled,m=B===undefined?true:B,u=f.imageSmoothingQuality,k=u===undefined?"low":u,v=f.maxWidth,s=v===undefined?Infinity:v,D=f.maxHeight,F=D===undefined?Infinity:D,q=f.minWidth,l=q===undefined?0:q,o=f.minHeight,r=o===undefined?0:o;var E=getContainSizes({aspectRatio:t,width:s,height:F});var y=getContainSizes({aspectRatio:t,width:l,height:r});var a=Math.min(E.width,Math.max(y.width,g));var c=Math.min(E.height,Math.max(y.height,j));var e=document.createElement("canvas");var I=e.getContext("2d");var b=[-C/2,-x/2,C,x];e.width=normalizeDecimalNumber(a);e.height=normalizeDecimalNumber(c);I.fillStyle=J;I.fillRect(0,0,a,c);I.save();I.translate(a/2,c/2);I.rotate(G*Math.PI/180);I.scale(A,z);I.imageSmoothingEnabled=!!m;I.imageSmoothingQuality=k;I.drawImage.apply(I,[d].concat(_toConsumableArray($.map(b,function(K){return Math.floor(normalizeDecimalNumber(K))}))));I.restore();return e}var fromCharCode=String.fromCharCode;function getStringFromCharCode(d,e,b){var c="";var a=void 0;b+=e;for(a=e;a<b;a+=1){c+=fromCharCode(d.getUint8(a))}return c}var REGEXP_DATA_URL_HEAD=/^data:.*,/;function dataURLToArrayBuffer(d){var b=d.replace(REGEXP_DATA_URL_HEAD,"");var e=atob(b);var c=new ArrayBuffer(e.length);var a=new Uint8Array(c);$.each(a,function(f){a[f]=e.charCodeAt(f)});return c}function arrayBufferToDataURL(b,d){var a=new Uint8Array(b);var c="";$.each(a,function(e,f){c+=fromCharCode(f)});return"data:"+d+";base64,"+btoa(c)}function getOrientation(h){var m=new DataView(h);var c=void 0;var b=void 0;var g=void 0;var p=void 0;if(m.getUint8(0)===255&&m.getUint8(1)===216){var d=m.byteLength;var e=2;while(e<d){if(m.getUint8(e)===255&&m.getUint8(e+1)===225){g=e;break}e+=1}}if(g){var o=g+4;var l=g+10;if(getStringFromCharCode(m,o,4)==="Exif"){var k=m.getUint16(l);b=k===18761;if(b||k===19789){if(m.getUint16(l+2,b)===42){var a=m.getUint32(l+4,b);if(a>=8){p=l+a}}}}}if(p){var j=m.getUint16(p,b);var n=void 0;var f=void 0;for(f=0;f<j;f+=1){n=p+f*12+2;if(m.getUint16(n,b)===274){n+=8;c=m.getUint16(n,b);m.setUint16(n,1,b);break}}}return c}function parseOrientation(b){var d=0;var c=1;var a=1;switch(b){case 2:c=-1;break;case 3:d=-180;break;case 4:a=-1;break;case 5:d=90;a=-1;break;case 6:d=90;break;case 7:d=90;c=-1;break;case 8:d=-90;break;default:}return{rotate:d,scaleX:c,scaleY:a}}var render={render:function render(){this.initContainer();this.initCanvas();this.initCropBox();this.renderCanvas();if(this.cropped){this.renderCropBox()}},initContainer:function initContainer(){var a=this.$element,c=this.options,d=this.$container,b=this.$cropper;b.addClass(CLASS_HIDDEN);a.removeClass(CLASS_HIDDEN);b.css(this.container={width:Math.max(d.width(),Number(c.minContainerWidth)||200),height:Math.max(d.height(),Number(c.minContainerHeight)||100)});a.addClass(CLASS_HIDDEN);b.removeClass(CLASS_HIDDEN)},initCanvas:function initCanvas(){var a=this.container,f=this.image;var d=this.options.viewMode;var c=Math.abs(f.rotate)%180===90;var h=c?f.naturalHeight:f.naturalWidth;var i=c?f.naturalWidth:f.naturalHeight;var j=h/i;var e=a.width;var g=a.height;if(a.height*j>a.width){if(d===3){e=a.height*j}else{g=a.width/j}}else{if(d===3){g=a.width/j}else{e=a.height*j}}var b={aspectRatio:j,naturalWidth:h,naturalHeight:i,width:e,height:g};b.left=(a.width-e)/2;b.top=(a.height-g)/2;b.oldLeft=b.left;b.oldTop=b.top;this.canvas=b;this.limited=d===1||d===2;this.limitCanvas(true,true);this.initialImage=$.extend({},f);this.initialCanvas=$.extend({},b)},limitCanvas:function limitCanvas(j,g){var n=this.options,a=this.container,c=this.canvas,f=this.cropBox;var e=n.viewMode;var l=c.aspectRatio;var k=this.cropped&&f;if(j){var m=Number(n.minCanvasWidth)||0;var h=Number(n.minCanvasHeight)||0;if(e>0){if(e>1){m=Math.max(m,a.width);h=Math.max(h,a.height);if(e===3){if(h*l>m){m=h*l}else{h=m/l}}}else{if(m){m=Math.max(m,k?f.width:0)}else{if(h){h=Math.max(h,k?f.height:0)}else{if(k){m=f.width;h=f.height;if(h*l>m){m=h*l}else{h=m/l}}}}}}var d=getContainSizes({aspectRatio:l,width:m,height:h});m=d.width;h=d.height;c.minWidth=m;c.minHeight=h;c.maxWidth=Infinity;c.maxHeight=Infinity}if(g){if(e>0){var b=a.width-c.width;var i=a.height-c.height;c.minLeft=Math.min(0,b);c.minTop=Math.min(0,i);c.maxLeft=Math.max(0,b);c.maxTop=Math.max(0,i);if(k&&this.limited){c.minLeft=Math.min(f.left,f.left+f.width-c.width);c.minTop=Math.min(f.top,f.top+f.height-c.height);c.maxLeft=f.left;c.maxTop=f.top;if(e===2){if(c.width>=a.width){c.minLeft=Math.min(0,b);c.maxLeft=Math.max(0,b)}if(c.height>=a.height){c.minTop=Math.min(0,i);c.maxTop=Math.max(0,i)}}}}else{c.minLeft=-c.width;c.minTop=-c.height;c.maxLeft=a.width;c.maxTop=a.height}}},renderCanvas:function renderCanvas(f,e){var c=this.canvas,d=this.image;if(e){var b=getRotatedSizes({width:d.naturalWidth*Math.abs(d.scaleX||1),height:d.naturalHeight*Math.abs(d.scaleY||1),degree:d.rotate||0}),g=b.width,h=b.height;var a=c.width*(g/c.naturalWidth);var i=c.height*(h/c.naturalHeight);c.left-=(a-c.width)/2;c.top-=(i-c.height)/2;c.width=a;c.height=i;c.aspectRatio=g/h;c.naturalWidth=g;c.naturalHeight=h;this.limitCanvas(true,false)}if(c.width>c.maxWidth||c.width<c.minWidth){c.left=c.oldLeft}if(c.height>c.maxHeight||c.height<c.minHeight){c.top=c.oldTop}c.width=Math.min(Math.max(c.width,c.minWidth),c.maxWidth);c.height=Math.min(Math.max(c.height,c.minHeight),c.maxHeight);this.limitCanvas(false,true);c.left=Math.min(Math.max(c.left,c.minLeft),c.maxLeft);c.top=Math.min(Math.max(c.top,c.minTop),c.maxTop);c.oldLeft=c.left;c.oldTop=c.top;this.$canvas.css({width:c.width,height:c.height,transform:getTransformValues({translateX:c.left,translateY:c.top})});this.renderImage(f);if(this.cropped&&this.limited){this.limitCropBox(true,true)}},renderImage:function renderImage(e){var b=this.canvas,d=this.image;var c=d.naturalWidth*(b.width/b.naturalWidth);var a=d.naturalHeight*(b.height/b.naturalHeight);$.extend(d,{width:c,height:a,left:(b.width-c)/2,top:(b.height-a)/2});this.$clone.css({width:d.width,height:d.height,transform:getTransformValues($.extend({translateX:d.left,translateY:d.top},d))});if(e){this.output()}},initCropBox:function initCropBox(){var b=this.options,a=this.canvas;var d=b.aspectRatio;var e=Number(b.autoCropArea)||0.8;var c={width:a.width,height:a.height};if(d){if(a.height*d>a.width){c.height=c.width/d}else{c.width=c.height*d}}this.cropBox=c;this.limitCropBox(true,true);c.width=Math.min(Math.max(c.width,c.minWidth),c.maxWidth);c.height=Math.min(Math.max(c.height,c.minHeight),c.maxHeight);c.width=Math.max(c.minWidth,c.width*e);c.height=Math.max(c.minHeight,c.height*e);c.left=a.left+(a.width-c.width)/2;c.top=a.top+(a.height-c.height)/2;c.oldLeft=c.left;c.oldTop=c.top;this.initialCropBox=$.extend({},c)},limitCropBox:function limitCropBox(h,e){var l=this.options,b=this.container,c=this.canvas,d=this.cropBox,i=this.limited;var k=l.aspectRatio;if(h){var a=Number(l.minCropBoxWidth)||0;var f=Number(l.minCropBoxHeight)||0;var g=Math.min(b.width,i?c.width:b.width);var j=Math.min(b.height,i?c.height:b.height);a=Math.min(a,b.width);f=Math.min(f,b.height);if(k){if(a&&f){if(f*k>a){f=a/k}else{a=f*k}}else{if(a){f=a/k}else{if(f){a=f*k}}}if(j*k>g){j=g/k}else{g=j*k}}d.minWidth=Math.min(a,g);d.minHeight=Math.min(f,j);d.maxWidth=g;d.maxHeight=j}if(e){if(i){d.minLeft=Math.max(0,c.left);d.minTop=Math.max(0,c.top);d.maxLeft=Math.min(b.width,c.left+c.width)-d.width;d.maxTop=Math.min(b.height,c.top+c.height)-d.height}else{d.minLeft=0;d.minTop=0;d.maxLeft=b.width-d.width;d.maxTop=b.height-d.height}}},renderCropBox:function renderCropBox(){var b=this.options,a=this.container,c=this.cropBox;if(c.width>c.maxWidth||c.width<c.minWidth){c.left=c.oldLeft}if(c.height>c.maxHeight||c.height<c.minHeight){c.top=c.oldTop}c.width=Math.min(Math.max(c.width,c.minWidth),c.maxWidth);c.height=Math.min(Math.max(c.height,c.minHeight),c.maxHeight);this.limitCropBox(false,true);c.left=Math.min(Math.max(c.left,c.minLeft),c.maxLeft);c.top=Math.min(Math.max(c.top,c.minTop),c.maxTop);c.oldLeft=c.left;c.oldTop=c.top;if(b.movable&&b.cropBoxMovable){this.$face.data(DATA_ACTION,c.width>=a.width&&c.height>=a.height?ACTION_MOVE:ACTION_ALL)}this.$cropBox.css({width:c.width,height:c.height,transform:getTransformValues({translateX:c.left,translateY:c.top})});if(this.cropped&&this.limited){this.limitCanvas(true,true)}if(!this.disabled){this.output()}},output:function output(){this.preview();if(this.completed){this.trigger(EVENT_CROP,this.getData())}}};var preview={initPreview:function initPreview(){var a=this.crossOrigin;var b=a?this.crossOriginUrl:this.url;var c=document.createElement("img");if(a){c.crossOrigin=a}c.src=b;var d=$(c);this.$preview=$(this.options.preview);this.$clone2=d;this.$viewBox.html(d);this.$preview.each(function(h,g){var e=$(g);var f=document.createElement("img");e.data(DATA_PREVIEW,{width:e.width(),height:e.height(),html:e.html()});if(a){f.crossOrigin=a}f.src=b;f.style.cssText='display:block;width:100%;height:auto;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important;"';e.html(f)})},resetPreview:function resetPreview(){this.$preview.each(function(c,b){var a=$(b);var d=a.data(DATA_PREVIEW);a.css({width:d.width,height:d.height}).html(d.html).removeData(DATA_PREVIEW)})},preview:function preview(){var e=this.image,c=this.canvas,f=this.cropBox;var a=f.width,g=f.height;var b=e.width,i=e.height;var d=f.left-c.left-e.left;var h=f.top-c.top-e.top;if(!this.cropped||this.disabled){return}this.$clone2.css({width:b,height:i,transform:getTransformValues($.extend({translateX:-d,translateY:-h},e))});this.$preview.each(function(o,p){var r=$(p);var l=r.data(DATA_PREVIEW);var k=l.width;var m=l.height;var n=k;var j=m;var q=1;if(a){q=k/a;j=g*q}if(g&&j>m){q=m/g;n=a*q;j=m}r.css({width:n,height:j}).find("img").css({width:b*q,height:i*q,transform:getTransformValues($.extend({translateX:-d*q,translateY:-h*q},e))})})}};var events={bind:function bind(){var a=this.$element,c=this.options,b=this.$cropper;if($.isFunction(c.cropstart)){a.on(EVENT_CROP_START,c.cropstart)}if($.isFunction(c.cropmove)){a.on(EVENT_CROP_MOVE,c.cropmove)}if($.isFunction(c.cropend)){a.on(EVENT_CROP_END,c.cropend)}if($.isFunction(c.crop)){a.on(EVENT_CROP,c.crop)}if($.isFunction(c.zoom)){a.on(EVENT_ZOOM,c.zoom)}b.on(EVENT_POINTER_DOWN,proxy(this.cropStart,this));if(c.zoomable&&c.zoomOnWheel){b.on(EVENT_WHEEL,proxy(this.wheel,this))}if(c.toggleDragModeOnDblclick){b.on(EVENT_DBLCLICK,proxy(this.dblclick,this))}$(document).on(EVENT_POINTER_MOVE,this.onCropMove=proxy(this.cropMove,this)).on(EVENT_POINTER_UP,this.onCropEnd=proxy(this.cropEnd,this));if(c.responsive){$(window).on(EVENT_RESIZE,this.onResize=proxy(this.resize,this))}},unbind:function unbind(){var a=this.$element,c=this.options,b=this.$cropper;if($.isFunction(c.cropstart)){a.off(EVENT_CROP_START,c.cropstart)}if($.isFunction(c.cropmove)){a.off(EVENT_CROP_MOVE,c.cropmove)}if($.isFunction(c.cropend)){a.off(EVENT_CROP_END,c.cropend)}if($.isFunction(c.crop)){a.off(EVENT_CROP,c.crop)}if($.isFunction(c.zoom)){a.off(EVENT_ZOOM,c.zoom)}b.off(EVENT_POINTER_DOWN,this.cropStart);if(c.zoomable&&c.zoomOnWheel){b.off(EVENT_WHEEL,this.wheel)}if(c.toggleDragModeOnDblclick){b.off(EVENT_DBLCLICK,this.dblclick)}$(document).off(EVENT_POINTER_MOVE,this.onCropMove).off(EVENT_POINTER_UP,this.onCropEnd);if(c.responsive){$(window).off(EVENT_RESIZE,this.onResize)}}};var handlers={resize:function resize(){var d=this.options,h=this.$container,a=this.container;var g=Number(d.minContainerWidth)||200;var b=Number(d.minContainerHeight)||100;if(this.disabled||a.width<=g||a.height<=b){return}var e=h.width()/a.width;if(e!==1||h.height()!==a.height){var c=void 0;var f=void 0;if(d.restore){c=this.getCanvasData();f=this.getCropBoxData()}this.render();if(d.restore){this.setCanvasData($.each(c,function(j,k){c[j]=k*e}));this.setCropBoxData($.each(f,function(j,k){f[j]=k*e}))}}},dblclick:function dblclick(){if(this.disabled||this.options.dragMode===DRAG_MODE_NONE){return}this.setDragMode(this.$dragBox.hasClass(CLASS_CROP)?DRAG_MODE_MOVE:DRAG_MODE_CROP)},wheel:function wheel(b){var f=this;var c=b.originalEvent||b;var a=Number(this.options.wheelZoomRatio)||0.1;if(this.disabled){return}b.preventDefault();if(this.wheeling){return}this.wheeling=true;setTimeout(function(){f.wheeling=false},50);var d=1;if(c.deltaY){d=c.deltaY>0?1:-1}else{if(c.wheelDelta){d=-c.wheelDelta/120}else{if(c.detail){d=c.detail>0?1:-1}}}this.zoom(-d*a,b)},cropStart:function cropStart(f){if(this.disabled){return}var c=this.options,b=this.pointers;var a=f.originalEvent;var d=void 0;if(a&&a.changedTouches){$.each(a.changedTouches,function(e,g){b[g.identifier]=getPointer(g)})}else{b[a&&a.pointerId||0]=getPointer(a||f)}if(objectKeys(b).length>1&&c.zoomable&&c.zoomOnTouch){d=ACTION_ZOOM}else{d=$(f.target).data(DATA_ACTION)}if(!REGEXP_ACTIONS.test(d)){return}if(this.trigger(EVENT_CROP_START,{originalEvent:a,action:d}).isDefaultPrevented()){return}f.preventDefault();this.action=d;this.cropping=false;if(d===ACTION_CROP){this.cropping=true;this.$dragBox.addClass(CLASS_MODAL)}},cropMove:function cropMove(d){var c=this.action;if(this.disabled||!c){return}var b=this.pointers;var a=d.originalEvent;d.preventDefault();if(this.trigger(EVENT_CROP_MOVE,{originalEvent:a,action:c}).isDefaultPrevented()){return}if(a&&a.changedTouches){$.each(a.changedTouches,function(e,f){$.extend(b[f.identifier],getPointer(f,true))})}else{$.extend(b[a&&a.pointerId||0],getPointer(a||d,true))}this.change(d)},cropEnd:function cropEnd(d){if(this.disabled){return}var c=this.action;var b=this.pointers;var a=d.originalEvent;if(a&&a.changedTouches){$.each(a.changedTouches,function(e,f){delete b[f.identifier]})}else{delete b[a&&a.pointerId||0]}if(!c){return}d.preventDefault();if(!objectKeys(b).length){this.action=""}if(this.cropping){this.cropping=false;this.$dragBox.toggleClass(CLASS_MODAL,this.cropped&&this.options.modal)}this.trigger(EVENT_CROP_END,{originalEvent:a,action:c})}};var change={change:function change(v){var d=this.options,j=this.pointers,k=this.container,c=this.canvas,a=this.cropBox;var t=this.action;var b=d.aspectRatio;var f=a.left,m=a.top,r=a.width,n=a.height;var x=f+r;var h=m+n;var o=0;var i=0;var u=k.width;var q=k.height;var p=true;var g=void 0;if(!b&&v.shiftKey){b=r&&n?r/n:1}if(this.limited){o=a.minLeft;i=a.minTop;u=o+Math.min(k.width,c.width,c.left+c.width);q=i+Math.min(k.height,c.height,c.top+c.height)}var s=j[objectKeys(j)[0]];var l={x:s.endX-s.startX,y:s.endY-s.startY};var w=function w(e){switch(e){case ACTION_EAST:if(x+l.x>u){l.x=u-x}break;case ACTION_WEST:if(f+l.x<o){l.x=o-f}break;case ACTION_NORTH:if(m+l.y<i){l.y=i-m}break;case ACTION_SOUTH:if(h+l.y>q){l.y=q-h}break;default:}};switch(t){case ACTION_ALL:f+=l.x;m+=l.y;break;case ACTION_EAST:if(l.x>=0&&(x>=u||b&&(m<=i||h>=q))){p=false;break}w(ACTION_EAST);r+=l.x;if(b){n=r/b;m-=l.x/b/2}if(r<0){t=ACTION_WEST;r=0}break;case ACTION_NORTH:if(l.y<=0&&(m<=i||b&&(f<=o||x>=u))){p=false;break}w(ACTION_NORTH);n-=l.y;m+=l.y;if(b){r=n*b;f+=l.y*b/2}if(n<0){t=ACTION_SOUTH;n=0}break;case ACTION_WEST:if(l.x<=0&&(f<=o||b&&(m<=i||h>=q))){p=false;break}w(ACTION_WEST);r-=l.x;f+=l.x;if(b){n=r/b;m+=l.x/b/2}if(r<0){t=ACTION_EAST;r=0}break;case ACTION_SOUTH:if(l.y>=0&&(h>=q||b&&(f<=o||x>=u))){p=false;break}w(ACTION_SOUTH);n+=l.y;if(b){r=n*b;f-=l.y*b/2}if(n<0){t=ACTION_NORTH;n=0}break;case ACTION_NORTH_EAST:if(b){if(l.y<=0&&(m<=i||x>=u)){p=false;break}w(ACTION_NORTH);n-=l.y;m+=l.y;r=n*b}else{w(ACTION_NORTH);w(ACTION_EAST);if(l.x>=0){if(x<u){r+=l.x}else{if(l.y<=0&&m<=i){p=false}}}else{r+=l.x}if(l.y<=0){if(m>i){n-=l.y;m+=l.y}}else{n-=l.y;m+=l.y}}if(r<0&&n<0){t=ACTION_SOUTH_WEST;n=0;r=0}else{if(r<0){t=ACTION_NORTH_WEST;r=0}else{if(n<0){t=ACTION_SOUTH_EAST;n=0}}}break;case ACTION_NORTH_WEST:if(b){if(l.y<=0&&(m<=i||f<=o)){p=false;break}w(ACTION_NORTH);n-=l.y;m+=l.y;r=n*b;f+=l.y*b}else{w(ACTION_NORTH);w(ACTION_WEST);if(l.x<=0){if(f>o){r-=l.x;f+=l.x}else{if(l.y<=0&&m<=i){p=false}}}else{r-=l.x;f+=l.x}if(l.y<=0){if(m>i){n-=l.y;m+=l.y}}else{n-=l.y;m+=l.y}}if(r<0&&n<0){t=ACTION_SOUTH_EAST;n=0;r=0}else{if(r<0){t=ACTION_NORTH_EAST;r=0}else{if(n<0){t=ACTION_SOUTH_WEST;n=0}}}break;case ACTION_SOUTH_WEST:if(b){if(l.x<=0&&(f<=o||h>=q)){p=false;break}w(ACTION_WEST);r-=l.x;f+=l.x;n=r/b}else{w(ACTION_SOUTH);w(ACTION_WEST);if(l.x<=0){if(f>o){r-=l.x;f+=l.x}else{if(l.y>=0&&h>=q){p=false}}}else{r-=l.x;f+=l.x}if(l.y>=0){if(h<q){n+=l.y}}else{n+=l.y}}if(r<0&&n<0){t=ACTION_NORTH_EAST;n=0;r=0}else{if(r<0){t=ACTION_SOUTH_EAST;r=0}else{if(n<0){t=ACTION_NORTH_WEST;n=0}}}break;case ACTION_SOUTH_EAST:if(b){if(l.x>=0&&(x>=u||h>=q)){p=false;break}w(ACTION_EAST);r+=l.x;n=r/b}else{w(ACTION_SOUTH);w(ACTION_EAST);if(l.x>=0){if(x<u){r+=l.x}else{if(l.y>=0&&h>=q){p=false}}}else{r+=l.x}if(l.y>=0){if(h<q){n+=l.y}}else{n+=l.y}}if(r<0&&n<0){t=ACTION_NORTH_WEST;n=0;r=0}else{if(r<0){t=ACTION_SOUTH_WEST;r=0}else{if(n<0){t=ACTION_NORTH_EAST;n=0}}}break;case ACTION_MOVE:this.move(l.x,l.y);p=false;break;case ACTION_ZOOM:this.zoom(getMaxZoomRatio(j),v.originalEvent);p=false;break;case ACTION_CROP:if(!l.x||!l.y){p=false;break}g=this.$cropper.offset();f=s.startX-g.left;m=s.startY-g.top;r=a.minWidth;n=a.minHeight;if(l.x>0){t=l.y>0?ACTION_SOUTH_EAST:ACTION_NORTH_EAST}else{if(l.x<0){f-=r;t=l.y>0?ACTION_SOUTH_WEST:ACTION_NORTH_WEST}}if(l.y<0){m-=n}if(!this.cropped){this.$cropBox.removeClass(CLASS_HIDDEN);this.cropped=true;if(this.limited){this.limitCropBox(true,true)}}break;default:}if(p){a.width=r;a.height=n;a.left=f;a.top=m;this.action=t;this.renderCropBox()}$.each(j,function(e,y){y.startX=y.endX;y.startY=y.endY})}};function _toConsumableArray$1(a){if(Array.isArray(a)){for(var c=0,b=Array(a.length);c<a.length;c++){b[c]=a[c]}return b}else{return Array.from(a)}}var methods={crop:function crop(){if(!this.ready||this.disabled){return}if(!this.cropped){this.cropped=true;this.limitCropBox(true,true);if(this.options.modal){this.$dragBox.addClass(CLASS_MODAL)}this.$cropBox.removeClass(CLASS_HIDDEN)}this.setCropBoxData(this.initialCropBox)},reset:function reset(){if(!this.ready||this.disabled){return}this.image=$.extend({},this.initialImage);this.canvas=$.extend({},this.initialCanvas);this.cropBox=$.extend({},this.initialCropBox);this.renderCanvas();if(this.cropped){this.renderCropBox()}},clear:function clear(){if(!this.cropped||this.disabled){return}$.extend(this.cropBox,{left:0,top:0,width:0,height:0});this.cropped=false;this.renderCropBox();this.limitCanvas(true,true);this.renderCanvas();this.$dragBox.removeClass(CLASS_MODAL);this.$cropBox.addClass(CLASS_HIDDEN)},replace:function replace(b,a){if(!this.disabled&&b){if(this.isImg){this.$element.attr("src",b)}if(a){this.url=b;this.$clone.attr("src",b);if(this.ready){this.$preview.find("img").add(this.$clone2).attr("src",b)}}else{if(this.isImg){this.replaced=true}this.options.data=null;this.load(b)}}},enable:function enable(){if(this.ready){this.disabled=false;this.$cropper.removeClass(CLASS_DISABLED)}},disable:function disable(){if(this.ready){this.disabled=true;this.$cropper.addClass(CLASS_DISABLED)}},destroy:function destroy(){var a=this.$element;if(this.loaded){if(this.isImg&&this.replaced){a.attr("src",this.originalUrl)}this.unbuild();a.removeClass(CLASS_HIDDEN)}else{if(this.isImg){a.off(EVENT_LOAD,this.start)}else{if(this.$clone){this.$clone.remove()}}}a.removeData(NAMESPACE)},move:function move(a,e){var b=this.canvas,d=b.left,c=b.top;this.moveTo(isUndefined(a)?a:d+Number(a),isUndefined(e)?e:c+Number(e))},moveTo:function moveTo(a,d){var b=this.canvas;var c=false;if(isUndefined(d)){d=a}a=Number(a);d=Number(d);if(this.ready&&!this.disabled&&this.options.movable){if(isNumber(a)){b.left=a;c=true}if(isNumber(d)){b.top=d;c=true}if(c){this.renderCanvas(true)}}},zoom:function zoom(c,a){var b=this.canvas;c=Number(c);if(c<0){c=1/(1-c)}else{c=1+c}this.zoomTo(b.width*c/b.naturalWidth,a)},zoomTo:function zoomTo(j,f){var n=this.options,l=this.pointers,e=this.canvas;var d=e.width,m=e.height,i=e.naturalWidth,k=e.naturalHeight;j=Number(j);if(j>=0&&this.ready&&!this.disabled&&n.zoomable){var h=i*j;var b=k*j;var c=void 0;if(f){c=f.originalEvent}if(this.trigger(EVENT_ZOOM,{originalEvent:c,oldRatio:d/i,ratio:h/i}).isDefaultPrevented()){return}if(c){var g=this.$cropper.offset();var a=l&&objectKeys(l).length?getPointersCenter(l):{pageX:f.pageX||c.pageX||0,pageY:f.pageY||c.pageY||0};e.left-=(h-d)*((a.pageX-g.left-e.left)/d);e.top-=(b-m)*((a.pageY-g.top-e.top)/m)}else{e.left-=(h-d)/2;e.top-=(b-m)/2}e.width=h;e.height=b;this.renderCanvas(true)}},rotate:function rotate(a){this.rotateTo((this.image.rotate||0)+Number(a))},rotateTo:function rotateTo(a){a=Number(a);if(isNumber(a)&&this.ready&&!this.disabled&&this.options.rotatable){this.image.rotate=a%360;this.renderCanvas(true,true)}},scaleX:function scaleX(b){var a=this.image.scaleY;this.scale(b,isNumber(a)?a:1)},scaleY:function scaleY(b){var a=this.image.scaleX;this.scale(isNumber(a)?a:1,b)},scale:function scale(c){var a=arguments.length>1&&arguments[1]!==undefined?arguments[1]:c;var d=this.image;var b=false;c=Number(c);a=Number(a);if(this.ready&&!this.disabled&&this.options.scalable){if(isNumber(c)){d.scaleX=c;b=true}if(isNumber(a)){d.scaleY=a;b=true}if(b){this.renderCanvas(true,true)}}},getData:function getData(){var a=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var c=this.options,g=this.image,b=this.canvas,e=this.cropBox;var f=void 0;if(this.ready&&this.cropped){f={x:e.left-b.left,y:e.top-b.top,width:e.width,height:e.height};var d=g.width/g.naturalWidth;$.each(f,function(h,j){j/=d;f[h]=a?Math.round(j):j})}else{f={x:0,y:0,width:0,height:0}}if(c.rotatable){f.rotate=g.rotate||0}if(c.scalable){f.scaleX=g.scaleX||1;f.scaleY=g.scaleY||1}return f},setData:function setData(f){var c=this.options,g=this.image,b=this.canvas;var e={};if($.isFunction(f)){f=f.call(this.element)}if(this.ready&&!this.disabled&&$.isPlainObject(f)){var a=false;if(c.rotatable){if(isNumber(f.rotate)&&f.rotate!==g.rotate){g.rotate=f.rotate;a=true}}if(c.scalable){if(isNumber(f.scaleX)&&f.scaleX!==g.scaleX){g.scaleX=f.scaleX;a=true}if(isNumber(f.scaleY)&&f.scaleY!==g.scaleY){g.scaleY=f.scaleY;a=true}}if(a){this.renderCanvas(true,true)}var d=g.width/g.naturalWidth;if(isNumber(f.x)){e.left=f.x*d+b.left}if(isNumber(f.y)){e.top=f.y*d+b.top}if(isNumber(f.width)){e.width=f.width*d}if(isNumber(f.height)){e.height=f.height*d}this.setCropBoxData(e)}},getContainerData:function getContainerData(){return this.ready?$.extend({},this.container):{}},getImageData:function getImageData(){return this.loaded?$.extend({},this.image):{}},getCanvasData:function getCanvasData(){var a=this.canvas;var b={};if(this.ready){$.each(["left","top","width","height","naturalWidth","naturalHeight"],function(c,d){b[d]=a[d]})}return b},setCanvasData:function setCanvasData(c){var a=this.canvas;var b=a.aspectRatio;if($.isFunction(c)){c=c.call(this.$element)}if(this.ready&&!this.disabled&&$.isPlainObject(c)){if(isNumber(c.left)){a.left=c.left}if(isNumber(c.top)){a.top=c.top}if(isNumber(c.width)){a.width=c.width;a.height=c.width/b}else{if(isNumber(c.height)){a.height=c.height;a.width=c.height*b}}this.renderCanvas(true)}},getCropBoxData:function getCropBoxData(){var a=this.cropBox;return this.ready&&this.cropped?{left:a.left,top:a.top,width:a.width,height:a.height}:{}},setCropBoxData:function setCropBoxData(e){var b=this.cropBox;var c=this.options.aspectRatio;var d=void 0;var a=void 0;if($.isFunction(e)){e=e.call(this.$element)}if(this.ready&&this.cropped&&!this.disabled&&$.isPlainObject(e)){if(isNumber(e.left)){b.left=e.left}if(isNumber(e.top)){b.top=e.top}if(isNumber(e.width)&&e.width!==b.width){d=true;b.width=e.width}if(isNumber(e.height)&&e.height!==b.height){a=true;b.height=e.height}if(c){if(d){b.height=b.width/c}else{if(a){b.width=b.height*c}}}this.renderCropBox()}},getCroppedCanvas:function getCroppedCanvas(){var k=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};if(!this.ready||!window.HTMLCanvasElement){return null}var q=this.canvas;var w=getSourceCanvas(this.$clone[0],this.image,q,k);if(!this.cropped){return w}var n=this.getData(),p=n.x,o=n.y,m=n.width,z=n.height;var c=m/z;var l=getContainSizes({aspectRatio:c,width:k.maxWidth||Infinity,height:k.maxHeight||Infinity});var D=getContainSizes({aspectRatio:c,width:k.minWidth||0,height:k.minHeight||0});var F=getContainSizes({aspectRatio:c,width:k.width||m,height:k.height||z}),v=F.width,u=F.height;v=Math.min(l.width,Math.max(D.width,v));u=Math.min(l.height,Math.max(D.height,u));var j=document.createElement("canvas");var f=j.getContext("2d");j.width=normalizeDecimalNumber(v);j.height=normalizeDecimalNumber(u);f.fillStyle=k.fillColor||"transparent";f.fillRect(0,0,v,u);var A=k.imageSmoothingEnabled,b=A===undefined?true:A,h=k.imageSmoothingQuality;f.imageSmoothingEnabled=b;if(h){f.imageSmoothingQuality=h}var r=w.width;var g=w.height;var a=p;var G=o;var t=void 0;var C=void 0;var e=void 0;var d=void 0;var i=void 0;var s=void 0;if(a<=-m||a>r){a=0;t=0;e=0;i=0}else{if(a<=0){e=-a;a=0;t=Math.min(r,m+a);i=t}else{if(a<=r){e=0;t=Math.min(m,r-a);i=t}}}if(t<=0||G<=-z||G>g){G=0;C=0;d=0;s=0}else{if(G<=0){d=-G;G=0;C=Math.min(g,z+G);s=C}else{if(G<=g){d=0;C=Math.min(z,g-G);s=C}}}var B=[a,G,t,C];if(i>0&&s>0){var E=v/m;B.push(e*E,d*E,i*E,s*E)}f.drawImage.apply(f,[w].concat(_toConsumableArray$1($.map(B,function(x){return Math.floor(normalizeDecimalNumber(x))}))));return j},setAspectRatio:function setAspectRatio(b){var a=this.options;if(!this.disabled&&!isUndefined(b)){a.aspectRatio=Math.max(0,b)||NaN;if(this.ready){this.initCropBox();if(this.cropped){this.renderCropBox()}}}},setDragMode:function setDragMode(d){var a=this.options;var c=void 0;var b=void 0;if(this.loaded&&!this.disabled){c=d===DRAG_MODE_CROP;b=a.movable&&d===DRAG_MODE_MOVE;d=c||b?d:DRAG_MODE_NONE;this.$dragBox.data(DATA_ACTION,d).toggleClass(CLASS_CROP,c).toggleClass(CLASS_MOVE,b);if(!a.cropBoxMovable){this.$face.data(DATA_ACTION,d).toggleClass(CLASS_CROP,c).toggleClass(CLASS_MOVE,b)}}}};var _createClass=function(){function a(e,c){for(var b=0;b<c.length;b++){var d=c[b];d.enumerable=d.enumerable||false;d.configurable=true;if("value" in d){d.writable=true}Object.defineProperty(e,d.key,d)}}return function(d,b,c){if(b){a(d.prototype,b)}if(c){a(d,c)}return d}}();function _classCallCheck(a,b){if(!(a instanceof b)){throw new TypeError("Cannot call a class as a function")}}var Cropper=function(){function g(m){var l=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};_classCallCheck(this,g);if(!m||!REGEXP_TAG_NAME.test(m.tagName)){throw new Error("The first argument is required and must be an <img> or <canvas> element.")}this.element=m;this.$element=$(m);this.options=$.extend({},DEFAULTS,$.isPlainObject(l)&&l);this.completed=false;this.cropped=false;this.disabled=false;this.isImg=false;this.limited=false;this.loaded=false;this.ready=false;this.replaced=false;this.wheeling=false;this.originalUrl="";this.canvas=null;this.cropBox=null;this.pointers={};this.init()}_createClass(g,[{key:"init",value:function j(){var l=this.$element;var m=void 0;if(l.is("img")){this.isImg=true;m=l.attr("src")||"";this.originalUrl=m;if(!m){return}m=l.prop("src")}else{if(l.is("canvas")&&window.HTMLCanvasElement){m=l[0].toDataURL()}}this.load(m)}},{key:"trigger",value:function c(l,m){var n=$.Event(l,m);this.$element.trigger(n);return n}},{key:"load",value:function i(n){var p=this;if(!n){return}this.url=n;this.image={};var l=this.$element,m=this.options;if(!m.checkOrientation||!window.ArrayBuffer){this.clone();return}if(REGEXP_DATA_URL.test(n)){if(REGEXP_DATA_URL_JPEG.test(n)){this.read(dataURLToArrayBuffer(n))}else{this.clone()}return}var o=new XMLHttpRequest();o.onerror=function(){p.clone()};o.onload=function(){p.read(o.response)};if(m.checkCrossOrigin&&isCrossOriginURL(n)&&l.prop("crossOrigin")){n=addTimestamp(n)}o.open("get",n);o.responseType="arraybuffer";o.withCredentials=l.prop("crossOrigin")==="use-credentials";o.send()}},{key:"read",value:function b(q){var p=this.options,r=this.image;var m=getOrientation(q);var o=0;var n=1;var l=1;if(m>1){this.url=arrayBufferToDataURL(q,"image/jpeg");var s=parseOrientation(m);o=s.rotate;n=s.scaleX;l=s.scaleY}if(p.rotatable){r.rotate=o}if(p.scalable){r.scaleX=n;r.scaleY=l}this.clone()}},{key:"clone",value:function e(){var l=this.$element,o=this.options,n=this.url;var m="";var p=void 0;if(o.checkCrossOrigin&&isCrossOriginURL(n)){m=l.prop("crossOrigin");if(m){p=n}else{m="anonymous";p=addTimestamp(n)}}this.crossOrigin=m;this.crossOriginUrl=p;var r=document.createElement("img");if(m){r.crossOrigin=m}r.src=p||n;var q=$(r);this.$clone=q;if(this.isImg){if(this.element.complete){this.start()}else{l.one(EVENT_LOAD,$.proxy(this.start,this))}}else{q.one(EVENT_LOAD,$.proxy(this.start,this)).one(EVENT_ERROR,$.proxy(this.stop,this)).addClass(CLASS_HIDE).insertAfter(l)}}},{key:"start",value:function a(){var m=this;var n=this.$clone;var l=this.$element;if(!this.isImg){n.off(EVENT_ERROR,this.stop);l=n}getImageNaturalSizes(l[0],function(o,p){$.extend(m.image,{naturalWidth:o,naturalHeight:p,aspectRatio:o/p});m.loaded=true;m.build()})}},{key:"stop",value:function f(){this.$clone.remove();this.$clone=null}},{key:"build",value:function h(){var q=this;if(!this.loaded){return}if(this.ready){this.unbuild()}var l=this.$element,p=this.options,r=this.$clone;var n=$(TEMPLATE);var m=n.find("."+NAMESPACE+"-crop-box");var o=m.find("."+NAMESPACE+"-face");this.$container=l.parent();this.$cropper=n;this.$canvas=n.find("."+NAMESPACE+"-canvas").append(r);this.$dragBox=n.find("."+NAMESPACE+"-drag-box");this.$cropBox=m;this.$viewBox=n.find("."+NAMESPACE+"-view-box");this.$face=o;l.addClass(CLASS_HIDDEN).after(n);if(!this.isImg){r.removeClass(CLASS_HIDE)}this.initPreview();this.bind();p.aspectRatio=Math.max(0,p.aspectRatio)||NaN;p.viewMode=Math.max(0,Math.min(3,Math.round(p.viewMode)))||0;this.cropped=p.autoCrop;if(p.autoCrop){if(p.modal){this.$dragBox.addClass(CLASS_MODAL)}}else{m.addClass(CLASS_HIDDEN)}if(!p.guides){m.find("."+NAMESPACE+"-dashed").addClass(CLASS_HIDDEN)}if(!p.center){m.find("."+NAMESPACE+"-center").addClass(CLASS_HIDDEN)}if(p.cropBoxMovable){o.addClass(CLASS_MOVE).data(DATA_ACTION,ACTION_ALL)}if(!p.highlight){o.addClass(CLASS_INVISIBLE)}if(p.background){n.addClass(NAMESPACE+"-bg")}if(!p.cropBoxResizable){m.find("."+NAMESPACE+"-line,."+NAMESPACE+"-point").addClass(CLASS_HIDDEN)}this.setDragMode(p.dragMode);this.render();this.ready=true;this.setData(p.data);this.completing=setTimeout(function(){if($.isFunction(p.ready)){l.one(EVENT_READY,p.ready)}q.trigger(EVENT_READY);q.trigger(EVENT_CROP,q.getData());q.completed=true},0)}},{key:"unbuild",value:function k(){if(!this.ready){return}if(!this.completed){clearTimeout(this.completing)}this.ready=false;this.completed=false;this.initialImage=null;this.initialCanvas=null;this.initialCropBox=null;this.container=null;this.canvas=null;this.cropBox=null;this.unbind();this.resetPreview();this.$preview=null;this.$viewBox=null;this.$cropBox=null;this.$dragBox=null;this.$canvas=null;this.$container=null;this.$cropper.remove();this.$cropper=null}}],[{key:"setDefaults",value:function d(l){$.extend(DEFAULTS,$.isPlainObject(l)&&l)}}]);return g}();if($.extend){$.extend(Cropper.prototype,render,preview,events,handlers,change,methods)}if($.fn){var AnotherCropper=$.fn.cropper;$.fn.cropper=function jQueryCropper(e){for(var b=arguments.length,c=Array(b>1?b-1:0),d=1;d<b;d++){c[d-1]=arguments[d]}var a=void 0;this.each(function(j,h){var f=$(h);var l=f.data(NAMESPACE);if(!l){if(/destroy/.test(e)){return}var g=$.extend({},f.data(),$.isPlainObject(e)&&e);l=new Cropper(h,g);f.data(NAMESPACE,l)}if(isString(e)){var k=l[e];if($.isFunction(k)){a=k.apply(l,c)}}});return isUndefined(a)?this:a};$.fn.cropper.Constructor=Cropper;$.fn.cropper.setDefaults=Cropper.setDefaults;$.fn.cropper.noConflict=function noConflict(){$.fn.cropper=AnotherCropper;return this}};